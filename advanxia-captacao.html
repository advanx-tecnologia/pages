<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0,viewport-fit=cover,maximum-scale=1.0,user-scalable=no">
<title>Advanx IA ‚Äî Intelig√™ncia Artificial para Advogados</title>
<!-- Meta Pixel -->
<script>!function(f,b,e,v,n,t,s){if(f.fbq)return;n=f.fbq=function(){n.callMethod?n.callMethod.apply(n,arguments):n.queue.push(arguments)};if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';n.queue=[];t=b.createElement(e);t.async=!0;t.src=v;s=b.getElementsByTagName(e)[0];s.parentNode.insertBefore(t,s)}(window,document,'script','https://connect.facebook.net/en_US/fbevents.js');fbq('init','502759528362336');fbq('track','PageView');</script>
<noscript><img height="1" width="1" style="display:none" src="https://www.facebook.com/tr?id=502759528362336&ev=PageView&noscript=1"/></noscript>
<!-- GA4 -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-98EL5GXG5F"></script>
<script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments);}gtag('js',new Date());gtag('config','G-98EL5GXG5F');</script>
<style>
*,*::before,*::after{margin:0;padding:0;box-sizing:border-box;-webkit-tap-highlight-color:transparent;}
html,body{width:100%;height:100%;overflow:hidden;background:#000;font-family:-apple-system,BlinkMacSystemFont,'SF Pro Text','Segoe UI',sans-serif;-webkit-font-smoothing:antialiased;}

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê CALL SCREEN ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
#call-screen{position:fixed;inset:0;z-index:100;overflow:hidden;}

.call-bg{
  position:absolute;inset:0;
  background:url('https://lhbwfbquxkutcyqazpnw.supabase.co/storage/v1/object/public/images/outro/Foto%20redonda.webp') center/cover no-repeat;
  filter:blur(30px) brightness(.28) saturate(1.5);
  transform:scale(1.15);
}
.call-ovl{
  position:absolute;inset:0;
  background:linear-gradient(to bottom,rgba(0,0,0,.35) 0%,rgba(0,0,0,.5) 55%,rgba(0,0,0,.85) 100%);
}

/*
  call-inner: flex coluna vertical
  ‚îå ios-sb          ‚Üê fixo
  ‚îú call-info        ‚Üê texto: chamada + nome + sub
  ‚îú call-photo-wrap  ‚Üê foto
  ‚îú (spacer flex:1)  ‚Üê empurra bot√µes para baixo
  ‚îú call-secondary   ‚Üê Lembrar-me + Mensagem
  ‚îî call-primary     ‚Üê Recusar + Atender + padding bottom
*/
.call-inner{
  position:relative;z-index:1;
  width:100%;height:100%;
  display:flex;flex-direction:column;align-items:center;
}

@keyframes shake{
  0%,100%{transform:translateX(0);}
  15%{transform:translateX(-5px) rotate(-.4deg);}
  30%{transform:translateX(5px) rotate(.4deg);}
  45%{transform:translateX(-4px);}
  60%{transform:translateX(4px);}
  75%{transform:translateX(-3px);}
  90%{transform:translateX(3px);}
}
.call-inner.shaking{animation:shake .55s ease-in-out;}

/* ‚îÄ‚îÄ Status bar ‚îÄ‚îÄ */
.ios-sb{
  width:100%;flex-shrink:0;
  display:flex;justify-content:space-between;align-items:center;
  padding:calc(env(safe-area-inset-top,14px) + 6px) 22px 0;
  color:#fff;
}
.ios-time{font-size:17px;font-weight:600;letter-spacing:-.4px;}
.ios-icons{display:flex;gap:6px;align-items:center;}

/* ‚îÄ‚îÄ Info (chamada recebida + nome + sub) ‚Äî ACIMA da foto ‚îÄ‚îÄ */
.call-info{
  flex-shrink:0;
  display:flex;flex-direction:column;align-items:center;
  margin-top:16px;gap:4px;text-align:center;padding:0 24px;
}
.call-received{color:rgba(255,255,255,.6);font-size:14px;font-weight:400;}
.call-name{color:#fff;font-size:clamp(20px,5.5vw,26px);font-weight:700;letter-spacing:-.4px;line-height:1.2;}
.call-sub{color:rgba(255,255,255,.55);font-size:15px;}

/* ‚îÄ‚îÄ Foto ‚îÄ‚îÄ */
@keyframes pring{0%{transform:scale(1);opacity:.45;}100%{transform:scale(1.8);opacity:0;}}
.call-photo-wrap{
  flex-shrink:0;position:relative;
  margin-top:clamp(18px,4vw,28px);
  width:110px;height:110px;
}
.pr{position:absolute;inset:-18px;border-radius:50%;background:rgba(255,255,255,.12);animation:pring 2.2s ease-out infinite;}
.pr:nth-child(2){animation-delay:.75s;}
.pr:nth-child(3){animation-delay:1.5s;}
.call-photo{width:110px;height:110px;border-radius:50%;object-fit:cover;border:2.5px solid rgba(255,255,255,.2);position:relative;z-index:1;}

/* ‚îÄ‚îÄ Spacer ‚îÄ‚îÄ */
.call-spacer{flex:1;}

/* ‚îÄ‚îÄ Bot√µes secund√°rios: Lembrar-me | Mensagem ‚îÄ‚îÄ */
.call-secondary{
  flex-shrink:0;
  width:100%;display:flex;justify-content:space-around;
  padding:0 52px;
  margin-bottom:18px;
}
.call-mini-wrap{display:flex;flex-direction:column;align-items:center;gap:7px;min-width:76px;}
.call-mini-btn{
  width:54px;height:54px;border-radius:50%;
  background:rgba(255,255,255,.18);backdrop-filter:blur(12px);
  display:flex;align-items:center;justify-content:center;
  cursor:pointer;
}
.call-mini-btn svg{width:22px;height:22px;}
.call-mini-label{color:rgba(255,255,255,.65);font-size:12px;font-weight:500;}

/* ‚îÄ‚îÄ Bot√µes prim√°rios: Recusar | Atender ‚îÄ‚îÄ */
.call-primary{
  flex-shrink:0;
  width:100%;display:flex;justify-content:space-around;align-items:center;
  padding:0 52px;
  padding-bottom:calc(env(safe-area-inset-bottom,0px) + 42px);
}
.call-btn-wrap{display:flex;flex-direction:column;align-items:center;gap:10px;}
.call-btn{
  width:72px;height:72px;border-radius:50%;border:none;cursor:pointer;
  display:flex;align-items:center;justify-content:center;
  transition:transform .15s,opacity .15s;
}
.call-btn:active{transform:scale(.88);opacity:.78;}
.call-btn-decline{background:#FF3B30;}
.call-btn-accept{background:#34C759;}
.call-btn svg{width:30px;height:30px;}
.call-btn-label{color:rgba(255,255,255,.8);font-size:13px;font-weight:500;}

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê WHATSAPP ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
#wa-screen{position:fixed;inset:0;z-index:200;display:none;flex-direction:column;background:#ECE5DD;}
#wa-screen.show{display:flex;}

.wa-hdr{
  background:#075E54;flex-shrink:0;
  padding:calc(env(safe-area-inset-top,0px) + 8px) 12px 8px;
  display:flex;align-items:center;gap:10px;
  box-shadow:0 1px 3px rgba(0,0,0,.3);
}
.wa-back{color:rgba(255,255,255,.75);font-size:22px;cursor:pointer;line-height:1;margin-right:2px;flex-shrink:0;}
.wa-av{width:40px;height:40px;border-radius:50%;object-fit:cover;border:1.5px solid rgba(255,255,255,.18);flex-shrink:0;}
.wa-cinfo{flex:1;min-width:0;display:flex;flex-direction:column;gap:1px;}
.wa-cname{color:#fff;font-size:16px;font-weight:600;line-height:1.2;}
.wa-csub{color:#FF7A01;font-size:11.5px;font-weight:700;letter-spacing:.1px;}
.wa-cstatus{color:rgba(255,255,255,.65);font-size:12px;}
.wa-hdr-icons{display:flex;gap:18px;color:rgba(255,255,255,.8);flex-shrink:0;}
.wa-hdr-icons svg{width:22px;height:22px;}

.wa-chat{
  flex:1;overflow-y:auto;
  padding:10px 8px 4px;
  display:flex;flex-direction:column;gap:2px;
  -webkit-overflow-scrolling:touch;
  background-color:#ECE5DD;
  background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='80' height='80'%3E%3Ccircle cx='10' cy='10' r='5' fill='%23b8a99a' fill-opacity='.13'/%3E%3Ccircle cx='48' cy='36' r='5' fill='%23b8a99a' fill-opacity='.13'/%3E%3Ccircle cx='68' cy='60' r='2.5' fill='%23b8a99a' fill-opacity='.1'/%3E%3C/svg%3E");
}

.wa-date-mkr{text-align:center;margin:6px 0 4px;}
.wa-date-mkr span{background:rgba(255,255,255,.82);color:#667781;font-size:12px;padding:4px 12px;border-radius:8px;}

@keyframes bubIn{from{opacity:0;transform:translateY(8px) scale(.97);}to{opacity:1;transform:none;}}
.bub{
  max-width:82%;padding:6px 9px 3px;border-radius:8px;
  font-size:14.5px;line-height:1.5;position:relative;
  word-break:break-word;animation:bubIn .2s ease-out;
}
.bub-rcv{background:#fff;color:#111;align-self:flex-start;margin-left:4px;border-top-left-radius:0;}
.bub-rcv::before{content:'';position:absolute;top:0;left:-8px;border-top:8px solid #fff;border-left:8px solid transparent;}
.bub-snt{background:#D9FDD3;color:#111;align-self:flex-end;margin-right:4px;border-top-right-radius:0;}
.bub-snt::after{content:'';position:absolute;top:0;right:-8px;border-top:8px solid #D9FDD3;border-right:8px solid transparent;}
.bub-meta{display:flex;justify-content:flex-end;align-items:center;gap:3px;margin-top:2px;}
.bub-time{font-size:11px;color:#667781;}
.bub-ticks{color:#53BDEB;font-size:13px;letter-spacing:-3px;display:inline-block;margin-left:1px;line-height:1;}

@keyframes dot{0%,60%,100%{transform:translateY(0);}30%{transform:translateY(-6px);}}
.typ-bub{background:#fff;border-radius:8px;border-top-left-radius:0;padding:12px 14px;align-self:flex-start;margin-left:4px;display:flex;gap:5px;align-items:center;position:relative;animation:bubIn .2s ease-out;}
.typ-bub::before{content:'';position:absolute;top:0;left:-8px;border-top:8px solid #fff;border-left:8px solid transparent;}
.td{width:8px;height:8px;border-radius:50%;background:#b0b7be;animation:dot 1.2s infinite;}
.td:nth-child(2){animation-delay:.2s;}
.td:nth-child(3){animation-delay:.4s;}

#input-zone{flex-shrink:0;}

.wa-ibar{background:#F0F0F0;padding:8px 8px calc(env(safe-area-inset-bottom,0px) + 8px);display:flex;align-items:flex-end;gap:8px;}
.wa-iwrap{flex:1;background:#fff;border-radius:22px;padding:9px 14px;display:flex;align-items:center;}
.wa-inp{flex:1;border:none;outline:none;font-size:15px;color:#111;background:transparent;font-family:inherit;}
.wa-inp::placeholder{color:#aaa;}
.wa-send{width:44px;height:44px;border-radius:50%;border:none;background:#075E54;color:#fff;cursor:pointer;display:flex;align-items:center;justify-content:center;flex-shrink:0;}
.wa-send:active{background:#054d44;}
.wa-send svg{width:20px;height:20px;}

.wa-chips{padding:10px 10px calc(env(safe-area-inset-bottom,0px) + 10px);background:#F0F0F0;display:flex;flex-wrap:wrap;gap:8px;justify-content:center;}
.chip{background:#fff;color:#075E54;border:1.5px solid #128C7E;padding:10px 18px;border-radius:20px;font-size:14px;font-weight:500;cursor:pointer;font-family:inherit;}
.chip:active{background:#075E54;color:#fff;}

.wa-group{background:#F0F0F0;padding:10px 10px calc(env(safe-area-inset-bottom,0px) + 10px);display:flex;flex-direction:column;gap:8px;}
.g-field{background:#fff;border-radius:12px;padding:10px 14px;display:flex;flex-direction:column;gap:3px;}
.g-label{font-size:11px;color:#667781;font-weight:600;text-transform:uppercase;letter-spacing:.5px;}
.g-inp{border:none;outline:none;font-size:15px;color:#111;background:transparent;font-family:inherit;width:100%;padding:2px 0;}
.g-inp::placeholder{color:#aaa;}
.g-sub{background:#075E54;color:#fff;border:none;border-radius:22px;padding:13px;font-size:15px;font-weight:600;font-family:inherit;cursor:pointer;}
.g-sub:active{opacity:.85;}

.wa-end{position:fixed;inset:0;z-index:300;background:#ECE5DD;display:flex;flex-direction:column;align-items:center;justify-content:center;padding:32px 28px;text-align:center;}
.wa-end-icon{font-size:64px;margin-bottom:20px;}
.wa-end-ttl{font-size:24px;font-weight:700;color:#111;margin-bottom:12px;line-height:1.2;}
.wa-end-txt{font-size:15px;color:#667781;line-height:1.7;max-width:300px;}
.wa-end-btn{margin-top:32px;padding:14px 36px;border-radius:26px;border:none;font-size:16px;font-weight:700;font-family:inherit;cursor:pointer;text-decoration:none;display:inline-block;}
.btn-wa{background:#25D366;color:#fff;}
.btn-ig{background:linear-gradient(45deg,#f09433,#e6683c,#dc2743,#cc2366,#bc1888);color:#fff;}
</style>
</head>
<body>

<audio id="ring" loop preload="auto">
  <source src="https://drive.google.com/uc?id=1CXlMl_PPyBRLrougQg4USq_mmImU5XnF&export=download" type="audio/mpeg">
</audio>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê CALL SCREEN ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<div id="call-screen">
  <div class="call-bg"></div>
  <div class="call-ovl"></div>

  <!-- FLEX COLUNA: topo ‚Üí base, sem position:absolute -->
  <div class="call-inner" id="call-inner">

    <!-- 1. Status bar -->
    <div class="ios-sb">
      <span class="ios-time" id="ios-clock">9:41</span>
      <div class="ios-icons">
        <svg width="17" height="12" viewBox="0 0 17 12" fill="white"><rect x="0" y="5" width="3" height="7" rx="1"/><rect x="4.5" y="3" width="3" height="9" rx="1"/><rect x="9" y="1" width="3" height="11" rx="1"/><rect x="13.5" y="0" width="3" height="12" rx="1" fill-opacity=".3"/></svg>
        <svg width="16" height="12" viewBox="0 0 16 12" fill="white"><path d="M8 2.4C10.6 2.4 12.9 3.5 14.6 5.2l1.3-1.3C13.8 1.8 11 .6 8 .6S2.2 1.8.1 3.9l1.3 1.3C3.1 3.5 5.4 2.4 8 2.4z"/><path d="M8 5.2c1.7 0 3.2.7 4.3 1.8l1.3-1.3C12.2 4.3 10.2 3.4 8 3.4S3.8 4.3 2.4 5.7l1.3 1.3C4.8 5.9 6.3 5.2 8 5.2z"/><path d="M8 8c1 0 1.9.4 2.6 1.1L8 11.6l-2.6-2.5C6.1 8.4 7 8 8 8z"/></svg>
        <svg width="26" height="12" viewBox="0 0 26 12" fill="none"><rect x=".5" y=".5" width="22" height="11" rx="3.3" stroke="white" stroke-opacity=".35"/><rect x="1.5" y="1.5" width="18" height="9" rx="2.3" fill="white"/><path d="M23.5 4v4a2 2 0 000-4z" fill="white" fill-opacity=".4"/></svg>
      </div>
    </div>

    <!-- 2. TEXTO ACIMA DA FOTO -->
    <div class="call-info">
      <div class="call-received">Chamada recebida</div>
      <div class="call-name">O futuro da advocacia chegou</div>
      <div class="call-sub">voc√™ vai atender ou n√£o?</div>
    </div>

    <!-- 3. FOTO -->
    <div class="call-photo-wrap">
      <div class="pr"></div><div class="pr"></div><div class="pr"></div>
      <img class="call-photo" src="https://lhbwfbquxkutcyqazpnw.supabase.co/storage/v1/object/public/images/outro/Foto%20redonda.webp" alt="Rafael">
    </div>

    <!-- 4. ESPA√áO FLEX√çVEL (empurra bot√µes para o fundo) -->
    <div class="call-spacer"></div>

    <!-- 5. SECUND√ÅRIOS: Lembrar-me | Mensagem -->
    <div class="call-secondary">
      <div class="call-mini-wrap">
        <div class="call-mini-btn">
          <!-- Rel√≥gio / alarme -->
          <svg viewBox="0 0 24 24" fill="white"><path d="M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zm.01 18c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8zm.5-13H11v6l5.25 3.15.75-1.23-4.5-2.67V7z"/></svg>
        </div>
        <span class="call-mini-label">Lembrar-me</span>
      </div>
      <div class="call-mini-wrap">
        <div class="call-mini-btn">
          <!-- Bal√£o de mensagem -->
          <svg viewBox="0 0 24 24" fill="white"><path d="M20 2H4c-1.1 0-2 .9-2 2v18l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm0 14H6l-2 2V4h16v12z"/></svg>
        </div>
        <span class="call-mini-label">Mensagem</span>
      </div>
    </div>

    <!-- 6. PRIM√ÅRIOS: Recusar | Atender -->
    <div class="call-primary">
      <div class="call-btn-wrap">
        <button class="call-btn call-btn-decline" id="btn-decline">
          <svg viewBox="0 0 24 24" fill="white"><path d="M12 9c-1.6 0-3.15.25-4.6.72v3.1c0 .39-.23.74-.56.9-.98.49-1.87 1.12-2.66 1.85-.18.18-.43.28-.7.28-.28 0-.53-.11-.71-.29L.29 13.08C.11 12.91 0 12.66 0 12.38c0-.28.11-.53.29-.71C3.34 8.78 7.46 7 12 7s8.66 1.78 11.71 4.67c.18.18.29.43.29.71 0 .28-.11.53-.29.71l-2.48 2.48c-.18.18-.43.29-.71.29-.27 0-.52-.1-.7-.28-.79-.73-1.68-1.36-2.66-1.85-.33-.16-.56-.51-.56-.9v-3.1C15.15 9.25 13.6 9 12 9z"/></svg>
        </button>
        <span class="call-btn-label">Recusar</span>
      </div>
      <div class="call-btn-wrap">
        <button class="call-btn call-btn-accept" id="btn-accept">
          <svg viewBox="0 0 24 24" fill="white"><path d="M6.6 10.8c1.4 2.8 3.8 5.1 6.6 6.6l2.2-2.2c.3-.3.7-.4 1-.2 1.1.4 2.3.6 3.6.6.6 0 1 .4 1 1V20c0 .6-.4 1-1 1C10.6 21 3 13.4 3 4c0-.6.4-1 1-1h3.5c.6 0 1 .4 1 1 0 1.3.2 2.5.6 3.6.1.3 0 .7-.2 1l-2.3 2.2z"/></svg>
        </button>
        <span class="call-btn-label">Atender</span>
      </div>
    </div>

  </div><!-- /call-inner -->
</div><!-- /call-screen -->

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê WHATSAPP ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<div id="wa-screen">
  <div class="wa-hdr">
    <span class="wa-back">&#8249;</span>
    <img class="wa-av" src="https://lhbwfbquxkutcyqazpnw.supabase.co/storage/v1/object/public/images/outro/Foto%20redonda.webp" alt="Rafael">
    <div class="wa-cinfo">
      <div class="wa-cname">Rafael Batista</div>
      <div class="wa-csub">Advanx IA</div>
      <div class="wa-cstatus" id="wa-status">online</div>
    </div>
    <div class="wa-hdr-icons">
      <svg viewBox="0 0 24 24" fill="currentColor"><path d="M6.6 10.8c1.4 2.8 3.8 5.1 6.6 6.6l2.2-2.2c.3-.3.7-.4 1-.2 1.1.4 2.3.6 3.6.6.6 0 1 .4 1 1V20c0 .6-.4 1-1 1C10.6 21 3 13.4 3 4c0-.6.4-1 1-1h3.5c.6 0 1 .4 1 1 0 1.3.2 2.5.6 3.6.1.3 0 .7-.2 1l-2.3 2.2z"/></svg>
      <svg viewBox="0 0 24 24" fill="currentColor"><circle cx="12" cy="5" r="2"/><circle cx="12" cy="12" r="2"/><circle cx="12" cy="19" r="2"/></svg>
    </div>
  </div>
  <div class="wa-chat" id="chat"></div>
  <div id="input-zone"></div>
</div>

<script>
var ANS = {};
var formStep = -1;

// Rel√≥gio
(function tick(){
  var d=new Date(),h=String(d.getHours()).padStart(2,'0'),m=String(d.getMinutes()).padStart(2,'0');
  document.getElementById('ios-clock').textContent=h+':'+m;
  setTimeout(tick,30000);
})();

// √Åudio
var ring=document.getElementById('ring');var ringOk=false;
function tryRing(){if(ringOk)return;ring.play().then(function(){ringOk=true;}).catch(function(){});}
tryRing();
document.addEventListener('touchstart',tryRing,{once:true,passive:true});
document.addEventListener('click',tryRing,{once:true});
function stopRing(){ring.pause();ring.currentTime=0;ringOk=false;}

// Vibra√ß√£o
var vibInt=null;
function startVib(){
  function v(){if(navigator.vibrate)navigator.vibrate([500,200,500,200,400]);}
  v();vibInt=setInterval(v,3200);
}
function stopVib(){if(vibInt){clearInterval(vibInt);vibInt=null;}if(navigator.vibrate)navigator.vibrate(0);}
startVib();

// Shake
var callInner=document.getElementById('call-inner');var shakeInt=null;
function startShake(){
  function s(){callInner.classList.add('shaking');setTimeout(function(){callInner.classList.remove('shaking');},560);}
  s();shakeInt=setInterval(s,3200);
}
function stopShake(){if(shakeInt){clearInterval(shakeInt);shakeInt=null;}}
startShake();

// Bot√µes da chamada
document.getElementById('btn-decline').addEventListener('click',function(){
  stopRing();stopVib();stopShake();
  setTimeout(function(){tryRing();startVib();startShake();},2200);
});
document.getElementById('btn-accept').addEventListener('click',function(){
  stopRing();stopVib();stopShake();
  var cs=document.getElementById('call-screen');
  cs.style.transition='opacity .35s ease';cs.style.opacity='0';
  setTimeout(function(){
    cs.style.display='none';
    document.getElementById('wa-screen').classList.add('show');
    if(typeof fbq!=='undefined')fbq('track','ViewContent');
    if(typeof gtag!=='undefined')gtag('event','call_accepted');
    setTimeout(startStory,420);
  },350);
});

// WA utils
var chat=document.getElementById('chat');
function ts(){var d=new Date();return String(d.getHours()).padStart(2,'0')+':'+String(d.getMinutes()).padStart(2,'0');}
function sc(){var l=chat.lastElementChild;if(l)l.scrollIntoView({behavior:'smooth',block:'end'});}
function escH(s){return String(s).replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;');}

function addRcv(text){
  var d=document.createElement('div');d.className='bub bub-rcv';
  d.innerHTML=escH(text).replace(/\n/g,'<br>')+'<div class="bub-meta"><span class="bub-time">'+ts()+'</span></div>';
  chat.appendChild(d);sc();
}
function addSnt(text){
  var d=document.createElement('div');d.className='bub bub-snt';
  d.innerHTML=escH(text).replace(/\n/g,'<br>')+'<div class="bub-meta"><span class="bub-time">'+ts()+'</span><span class="bub-ticks">‚úì‚úì</span></div>';
  chat.appendChild(d);sc();
}
function typing(ms){
  return new Promise(function(res){
    var el=document.createElement('div');el.className='typ-bub';
    el.innerHTML='<div class="td"></div><div class="td"></div><div class="td"></div>';
    chat.appendChild(el);sc();
    document.getElementById('wa-status').textContent='digitando...';
    setTimeout(function(){el.remove();document.getElementById('wa-status').textContent='online';res();},ms);
  });
}

// Hist√≥ria
var STORY=[
  {t:'Voc√™ atendeu.',d:600},
  {t:'E isso j√° diz muito sobre voc√™.',d:900},
  {t:'A maioria dos advogados prefere ignorar essa liga√ß√£o.',d:1100},
  {t:'Preferem continuar acreditando que o problema √© "mais tr√°fego", "mais indica√ß√£o", ou "mais tempo".',d:1800},
  {t:'Mas no fundo voc√™ j√° sabe.',d:700},
  {t:'O problema nunca foi falta de cliente.',d:900},
  {t:'Foi falta de controle.',d:600},
  {t:'Enquanto voc√™ atende manualmente, explica o b√°sico repetidamente e torce para o lead n√£o sumir...',d:1600},
  {t:'...outros escrit√≥rios j√° operam diferente.',d:800},
  {t:'Eles utilizam Intelig√™ncia Artificial para:\n\n‚Äî Qualificar antes de conversar\n‚Äî Calcular viabilidade automaticamente\n‚Äî Filtrar curiosos\n‚Äî Organizar follow-up\n‚Äî Registrar tudo em CRM\n‚Äî Controlar metas e prazos\n‚Äî Transformar atendimento em contrato',d:2500},
  {t:'N√£o √© sobre tecnologia.',d:700},
  {t:'√â sobre parar de improvisar.',d:700},
  {t:'A pergunta real n√£o √© se a IA funciona.',d:1000},
  {t:'Voc√™ vai continuar operando como em 2015‚Ä¶ ou vai estruturar seu escrit√≥rio para 2026? ü§î',d:1800},
  {t:'Antes de continuarmos, preciso entender uma coisa sobre o seu escrit√≥rio.',d:1300},
  {t:'Responda com sinceridade. üëá',d:700}
];

async function startStory(){
  var dm=document.createElement('div');dm.className='wa-date-mkr';
  var wd=new Date().toLocaleDateString('pt-BR',{weekday:'long'});
  dm.innerHTML='<span>'+wd.charAt(0).toUpperCase()+wd.slice(1)+'</span>';
  chat.appendChild(dm);
  for(var i=0;i<STORY.length;i++){
    await typing(STORY[i].d);
    addRcv(STORY[i].t);
    await new Promise(function(r){setTimeout(r,i<STORY.length-1?500:800);});
  }
  formStep=0;showStep();
}

// Perguntas
var QS=[
  {id:'esp',type:'choice',q:'Qual √© a sua especialidade?',opts:['Trabalhista','Previdenci√°rio','Fam√≠lia','Banc√°rio','Tribut√°rio','Imobili√°rio','Criminal','Outros']},
  {id:'col',type:'choice',q:'Quantos colaboradores no escrit√≥rio?',opts:['Apenas eu','1 a 3','4 a 9','Mais de 10']},
  {id:'fat',type:'choice',q:'Qual o faturamento m√©dio mensal?',opts:['0 a R$5 mil','R$5 a 10 mil','R$10 a 20 mil','R$20 a 50 mil','R$50 a 100 mil','Mais de R$100 mil']},
  {id:'traf',type:'choice',q:'Quanto investe em tr√°fego pago por m√™s?',opts:['N√£o invisto','At√© R$1 mil','R$1 a 2 mil','R$2 a 5 mil','R$5 a 10 mil','Mais de R$10 mil']},
  {id:'urg',type:'choice',q:'Quando pretende implementar IA no seu escrit√≥rio?',opts:['O quanto antes','Em at√© 30 dias','Ainda n√£o sei'],exitOn:'Ainda n√£o sei',exitType:'wait'},
  {id:'inv',type:'choice',
   q:function(){var n=(ANS.nome||'').split(' ')[0];return(n?n+', nossas':'Nossas')+' solu√ß√µes com IA t√™m parcelas de R$400 at√© R$4.000 mensais. Caso o que voc√™ veja, voc√™ entenda que vai te ajudar, voc√™ faria esse investimento?';},
   opts:['Sim','N√£o'],exitOn:'N√£o',exitType:'nofit'},
  {id:'ig',type:'text',q:'√ìtimo! Qual o seu Instagram? (opcional)',ph:'@seuinstagram',optional:true}
];

var iz=document.getElementById('input-zone');
function clrIz(){iz.innerHTML='';}

function showAfterTyping(text,cb){
  typing(680).then(function(){
    addRcv(text);
    setTimeout(function(){cb();setTimeout(sc,80);},320);
  });
}

function showStep(){
  if(formStep===0){showAfterTyping('Me conta um pouco sobre voc√™:',renderGroup);}
  else{
    var q=QS[formStep-1];if(!q){allDone();return;}
    var qt=typeof q.q==='function'?q.q():q.q;
    showAfterTyping(qt,function(){if(q.type==='choice')renderChips(q);else renderText(q);});
  }
}

// Group
function renderGroup(){
  clrIz();var w=document.createElement('div');w.className='wa-group';
  w.innerHTML='<div class="g-field"><div class="g-label">Nome completo</div><input id="g-nome" class="g-inp" type="text" placeholder="Seu nome" autocomplete="name"></div>'+
    '<div class="g-field"><div class="g-label">WhatsApp (com DDD)</div><input id="g-tel" class="g-inp" type="tel" placeholder="(71) 99999-9999" autocomplete="tel" inputmode="numeric"></div>'+
    '<div class="g-field"><div class="g-label">E-mail</div><input id="g-email" class="g-inp" type="email" placeholder="nome@email.com" autocomplete="email"></div>'+
    '<button class="g-sub" id="g-sub-btn">Continuar ‚Üí</button>';
  iz.appendChild(w);
  var tel=document.getElementById('g-tel');
  tel.addEventListener('input',function(){
    var v=this.value.replace(/\D/g,'').slice(0,11);
    if(v.length>7)v='('+v.slice(0,2)+') '+v.slice(2,7)+'-'+v.slice(7);
    else if(v.length>2)v='('+v.slice(0,2)+') '+v.slice(2);
    else if(v.length)v='('+v;
    this.value=v;
  });
  document.getElementById('g-sub-btn').addEventListener('click',submitGroup);
  ['g-nome','g-tel','g-email'].forEach(function(id){document.getElementById(id).addEventListener('keydown',function(e){if(e.key==='Enter'){e.preventDefault();submitGroup();}});});
  document.getElementById('g-nome').focus();
  setTimeout(sc,80);
}

function submitGroup(){
  var n=document.getElementById('g-nome'),t=document.getElementById('g-tel'),e=document.getElementById('g-email');
  var nome=n.value.trim(),tel=t.value.trim(),email=e.value.trim();
  if(nome.length<2){n.style.outline='2px solid #FF3B30';n.focus();return;}
  if(tel.replace(/\D/g,'').length<10){t.style.outline='2px solid #FF3B30';t.focus();return;}
  if(!email.includes('@')||!email.includes('.')){e.style.outline='2px solid #FF3B30';e.focus();return;}
  ANS.nome=nome;ANS.tel=tel;ANS.email=email;
  clrIz();addSnt(nome+'\n'+tel+'\n'+email);
  if(typeof fbq!=='undefined')fbq('track','ViewContent');
  formStep=1;setTimeout(showStep,680);
}

// Chips
function renderChips(q){
  clrIz();var w=document.createElement('div');w.className='wa-chips';
  q.opts.forEach(function(opt){
    var b=document.createElement('button');b.className='chip';b.textContent=opt;
    b.addEventListener('click',function(){
      var val=b.textContent;ANS[q.id]=val;clrIz();addSnt(val);
      if(q.exitOn&&val===q.exitOn){setTimeout(function(){handleExit(q.exitType);},680);return;}
      formStep++;setTimeout(showStep,680);
    });
    w.appendChild(b);
  });
  iz.appendChild(w);setTimeout(sc,80);
}

// Text
function renderText(q){
  clrIz();var w=document.createElement('div');w.className='wa-ibar';
  w.innerHTML='<div class="wa-iwrap"><input id="wa-inp" class="wa-inp" type="text" placeholder="'+(q.ph||'')+'"></div><button class="wa-send" id="wa-snd"><svg viewBox="0 0 24 24" fill="white"><path d="M2 21L23 12 2 3v7l15 2-15 2z"/></svg></button>';
  iz.appendChild(w);
  var inp=document.getElementById('wa-inp');
  function sub(){var v=inp.value.trim();if(!q.optional&&!v){inp.focus();return;}ANS[q.id]=v||'‚Äî';clrIz();if(v)addSnt(v);formStep++;if(!QS[formStep-1])setTimeout(allDone,680);else setTimeout(showStep,680);}
  document.getElementById('wa-snd').addEventListener('click',sub);
  inp.addEventListener('keydown',function(e){if(e.key==='Enter'){e.preventDefault();sub();}});
  inp.focus();setTimeout(sc,80);
}

// Exit
function handleExit(type){
  if(type==='wait'){typing(800).then(function(){addRcv('Sem problema! üòä\n\nQuando estiver pronto, √© s√≥ nos chamar.\nEstamos aqui para quando fizer sentido para voc√™!');setTimeout(function(){showEnd('wait');},1800);});}
  else{typing(800).then(function(){addRcv('Tudo bem! üôè\n\nAcompanhe o Instagram do Rafael para dicas sobre IA para advogados.');setTimeout(function(){showEnd('nofit');},1800);});}
}

// Done
function allDone(){
  if(typeof fbq!=='undefined')fbq('track','Lead');
  if(typeof gtag!=='undefined')gtag('event','generate_lead');
  var nome=(ANS.nome||'').split(' ')[0];
  typing(900).then(function(){
    addRcv('Perfeito, '+nome+'! üéâ\n\nRecebi tudo. Nossa equipe vai entrar em contato pelo WhatsApp para agendar sua apresenta√ß√£o!');
    setTimeout(function(){showEnd('success');},2000);
  });
}

// End screens
function showEnd(type){
  var s=document.createElement('div');s.className='wa-end';
  if(type==='success'){
    var msg=encodeURIComponent('Ol√°! Sou '+(ANS.nome||'')+' e acabei de preencher o formul√°rio da Advanx IA. Gostaria de ver a demonstra√ß√£o!');
    s.innerHTML='<div class="wa-end-icon">üöÄ</div><div class="wa-end-ttl">Cadastro realizado!</div><div class="wa-end-txt">Nossa equipe vai entrar em contato em breve.<br><br>Prefere agilizar? Fale com a gente agora.</div><a href="https://wa.me/5571982470873?text='+msg+'" target="_blank" class="wa-end-btn btn-wa">üí¨ Falar com a Advanx IA</a>';
  }else if(type==='wait'){
    s.innerHTML='<div class="wa-end-icon">‚è≥</div><div class="wa-end-ttl">At√© logo!</div><div class="wa-end-txt">Quando estiver pronto para estruturar seu escrit√≥rio com IA, a Advanx estar√° aqui.</div>';
  }else{
    s.innerHTML='<div class="wa-end-icon">üì≤</div><div class="wa-end-ttl">Acompanhe o Rafael</div><div class="wa-end-txt">Siga para receber dicas exclusivas sobre IA para advogados.</div><a href="https://www.instagram.com/rafaelbatistazz" target="_blank" class="wa-end-btn btn-ig">@rafaelbatistazz no Instagram</a>';
  }
  document.body.appendChild(s);
}
</script>
</body>
</html>
